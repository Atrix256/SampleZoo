function scandir(command)
    local i, t, popen = 0, {}, io.popen
    local pfile = popen(command)
    for filename in pfile:lines() do
        i = i + 1
        t[i] = filename
    end
    pfile:close()
    return t
end

print "=====Generating Code====="

local dotHHeader = "// Autogenerated by codegen.lua during premake process\n\n#pragma once\n\n"

-- make ./src/samples/samples.h
local file = io.open("./src/samples/samples.h", "w")
file:write(dotHHeader)
local sampleTypes = scandir('cd ./src/samples/ && ls -d ./*/ && cd ../..')
for k,v in pairs(sampleTypes) do
	local sampleType = string.sub(v,3,-2)
	file:write('#include "'..sampleType..'/'..sampleType..'.h"\n')
end
file:close()

-- make ./src/samples/X/X.h
for k,v in pairs(sampleTypes) do
	local sampleType = string.sub(v,3,-2)

	file = io.open("./src/samples/"..sampleType.."/"..sampleType..".h", "w")
	file:write(dotHHeader)

	local subSampleTypes = scandir('cd ./src/samples/'..sampleType..'/ && ls -d ./*/ && cd ../../..')

	for k2,v2 in pairs(subSampleTypes) do
		local subSampleType = string.sub(v2,3,-2)
		file:write('#include "'..subSampleType..'/'..subSampleType..'.h"\n')
	end

	file:close()
end

print "========================="